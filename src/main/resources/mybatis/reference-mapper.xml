<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Reference">
<insert id="insertDTO">
insert into reference values(reference_seq.nextval,#{writer},#{title},#{contents},sysdate)
</insert>
<select id="selectLastSeq" resultType="int">
select max(seq) from reference
</select>

<insert id="insertFileDTO">
insert into reference_file values(reference_file_seq.nextval,#{parentSeq},#{fileName},#{savedFileName},#{fileSize})
</insert>

<update id="update">
update reference set title=#{title},contents=#{contents}, write_date=sysdate where seq = #{seq}
</update>

<update id="updateFile">
update reference_file set filename=#{fileName},savedfilename=#{savedFileName},filesize=#{fileSize} where parentseq=#{parentSeq}
</update>

<delete id="delete">
	delete from reference where seq in 
	<foreach separator="," close=")" open="(" item="i" collection="list">#{i.seq} </foreach>
</delete>

<delete id="deleteFile">
	delete from reference_file where parentseq in 
	<foreach separator="," close=")" open="(" item="i" collection="list">#{i.seq} </foreach>
</delete>

<select id="selectAll" resultType="kh.spring.dto.ReferenceDTO">
select * from reference
</select>

<select id="selectFileAll" resultType="kh.spring.dto.Reference_FileDTO">
select * from reference_file
</select>

<delete id="deleteAll">
delete from reference_file where parentseq=#{parentSeq}
</delete>
</mapper>